# AWS Cost Optimizer Configuration

# Analysis settings
analysis:
  # Default analysis period in months
  default_months: 3
  # Maximum analysis period
  max_months: 12

  # Rightsizing thresholds
  thresholds:
    # CPU thresholds (percentage)
    cpu:
      oversized_p95_max: 40      # Below this = oversized
      rightsized_p95_max: 70     # Below this = right-sized, above = undersized
      contention_threshold: 80   # Above this = contention

    # Memory thresholds (percentage)
    memory:
      oversized_p95_max: 50
      rightsized_p95_max: 75
      contention_threshold: 85

    # Disk thresholds (percentage)
    disk:
      contention_threshold: 90

  # Minimum months of data required for confidence
  min_data_months: 2

  # Safety buffer for recommendations (percentage)
  safety_buffer: 20

# Dynatrace settings
dynatrace:
  # API timeout in seconds
  timeout: 30
  # Metrics resolution (h=hour, d=day)
  resolution: "1h"
  # Rate limiting (requests per minute)
  rate_limit: 50

# AWS settings
aws:
  # Default region
  default_region: "us-east-1"
  # Cost Explorer granularity (DAILY, MONTHLY)
  cost_granularity: "MONTHLY"
  # Regions to analyze (empty = all)
  regions: []

# Output settings
output:
  # Excel file settings
  excel:
    # Number format for currency
    currency_format: "$#,##0.00"
    # Number format for percentages
    percent_format: "0.0%"
    # Date format
    date_format: "YYYY-MM-DD"

  # Chart settings
  charts:
    # Default chart height (pixels)
    height: 400
    # Color scheme
    colors:
      oversized: "#28a745"    # Green - savings opportunity
      rightsized: "#6c757d"   # Gray - no change needed
      undersized: "#dc3545"   # Red - needs upgrade

# Logging
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# Anomaly Detection settings
anomaly_detection:
  # Enable/disable anomaly detection
  enabled: true
  # Number of days to use for baseline calculation
  baseline_days: 30
  # Number of recent days to check for anomalies
  detection_days: 7
  # Detection thresholds
  thresholds:
    warning:
      std_dev: 2.0      # Standard deviations from mean
      percentage: 30    # Percentage deviation from mean
    critical:
      std_dev: 3.0
      percentage: 50
  # Services to monitor (empty = all)
  services: []

# Scheduled Reports settings
scheduler:
  # Enable/disable scheduler daemon
  enabled: false
  # Timezone for schedule execution
  timezone: "UTC"

# Notifications settings
notifications:
  email:
    # SMTP server settings
    smtp_host: "smtp.example.com"
    smtp_port: 587
    use_tls: true
    # From address for reports
    from_address: "cost-optimizer@example.com"
  slack:
    # Default webhook URL (can be overridden per schedule)
    default_webhook: ""

# Report schedules
schedules:
  # Example schedule configuration
  # - id: "weekly-report"
  #   name: "Weekly Cost Report"
  #   cron: "0 8 * * MON"
  #   report_type: "full"
  #   recipients:
  #     - "team@example.com"
  #   slack_channel: "#cost-alerts"

# Multi-Account (AWS Organizations) settings
organizations:
  # Enable/disable multi-account mode
  enabled: false
  # Role name to assume in member accounts
  role_name: "CostOptimizerRole"
  # Session duration in seconds (max 3600 for chained roles)
  session_duration: 3600
  # Explicit account list (empty = auto-discover from Organizations)
  accounts: []
  # Example:
  # - account_id: "123456789012"
  #   name: "Production"
  #   role_name: "CostOptimizerRole"  # Optional, overrides default
  # - account_id: "234567890123"
  #   name: "Development"
